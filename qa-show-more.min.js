/*!
 * Q2A Show More plugin
 * Author: Chun
 * Project home: https://github.com/rxchun/q2a-show-more
 *
 * Readmore.js jQuery plugin
 * jQuery Plugin Author: jed_foster
 * Project home: http://jedfoster.github.io/Readmore.js
 *
 * Debounce function from http://davidwalsh.name/javascript-debounce-function
 */

!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";var e="readmore",o={speed:100,collapsedHeight:200,heightMargin:16,moreLink:'<a href="#">Read More</a>',lessLink:'<a href="#">Close</a>',embedCSS:!0,blockCSS:"display: block; width: 100%;",startOpen:!1,blockProcessed:function(){},beforeToggle:function(){},afterToggle:function(){}},i={},a=0;function n(t){var e=t.clone().css({height:"auto",width:t.width(),maxHeight:"none",overflow:"hidden"}).insertAfter(t),o=e.outerHeight(),i=parseInt(e.css({maxHeight:""}).css("max-height").replace(/[^-\d\.]/g,""),10),a=t.data("defaultHeight");e.remove();var n=i||t.data("collapsedHeight")||a;t.data({expandedHeight:o,maxHeight:i,collapsedHeight:n}).css({maxHeight:"none"})}var s,r,h,d=(s=function(){t("[data-readmore]").each(function(){var e=t(this),o="true"===e.attr("aria-expanded");n(e),e.css({height:e.data(o?"expandedHeight":"collapsedHeight")})})},function(){var t=this,e=arguments,o=function(){h=null,r||s.apply(t,e)},i=r&&!h;clearTimeout(h),h=setTimeout(o,100),i&&s.apply(t,e)});function l(a,n){this.element=a,this.options=t.extend({},o,n),function t(e){if(!i[e.selector]){var o,a,n,s=" ";e.embedCSS&&""!==e.blockCSS&&(s+=e.selector+" + [data-readmore-toggle], "+e.selector+"[data-readmore]{"+e.blockCSS+"}"),s+=e.selector+"[data-readmore]{transition: height "+e.speed+"ms;overflow: hidden;}",o=document,a=s,(n=o.createElement("style")).type="text/css",n.styleSheet?n.styleSheet.cssText=a:n.appendChild(o.createTextNode(a)),o.getElementsByTagName("head")[0].appendChild(n),i[e.selector]=!0}}(this.options),this._defaults=o,this._name=e,this.init(),window.addEventListener?(window.addEventListener("load",d),window.addEventListener("resize",d)):(window.attachEvent("load",d),window.attachEvent("resize",d))}l.prototype={init:function(){var e=t(this.element);e.data({defaultHeight:this.options.collapsedHeight,heightMargin:this.options.heightMargin}),n(e);var o=e.data("collapsedHeight"),i=e.data("heightMargin");if(e.outerHeight(!0)<=o+i)return this.options.blockProcessed&&"function"==typeof this.options.blockProcessed&&this.options.blockProcessed(e,!1),!0;var s,r,h,d=e.attr("id")||(r=++a,String(null===s?"rmjs-":s)+r),l=this.options.startOpen?this.options.lessLink:this.options.moreLink;e.attr({"data-readmore":"","aria-expanded":this.options.startOpen,id:d}),e.after(t(l).on("click",(h=this,function(t){h.toggle(this,e[0],t)})).attr({"data-readmore-toggle":d,"aria-controls":d})),this.options.startOpen||e.css({height:o}),this.options.blockProcessed&&"function"==typeof this.options.blockProcessed&&this.options.blockProcessed(e,!0)},toggle:function(e,o,i){i&&i.preventDefault(),e||(e=t('[aria-controls="'+this.element.id+'"]')[0]),o||(o=this.element);var a,n,s=t(o),r="",h="",d=!1,l=s.data("collapsedHeight");s.height()<=l?(r="unset",h="lessLink",d=!0):(r=l,h="moreLink"),this.options.beforeToggle&&"function"==typeof this.options.beforeToggle&&this.options.beforeToggle(e,s,!d),s.css({height:r}),s.on("transitionend",(a=this,function(){a.options.afterToggle&&"function"==typeof a.options.afterToggle&&a.options.afterToggle(e,s,d),t(this).attr({"aria-expanded":d}).off("transitionend")})),t(e).replaceWith(t(this.options[h]).on("click",(n=this,function(t){n.toggle(this,o,t)})).attr({"data-readmore-toggle":s.attr("id"),"aria-controls":s.attr("id")}))},destroy:function(){t(this.element).each(function(){var e=t(this);e.attr({"data-readmore":null,"aria-expanded":null}).css({maxHeight:"",height:""}).next("[data-readmore-toggle]").remove(),e.removeData()})}},t.fn.readmore=function(o){var i=arguments,a=this.selector;return"object"==typeof(o=o||{})?this.each(function(){if(t.data(this,"plugin_"+e)){var i=t.data(this,"plugin_"+e);i.destroy.apply(i)}o.selector=a,t.data(this,"plugin_"+e,new l(this,o))}):"string"==typeof o&&"_"!==o[0]&&"init"!==o?this.each(function(){var a=t.data(this,"plugin_"+e);a instanceof l&&"function"==typeof a[o]&&a[o].apply(a,Array.prototype.slice.call(i,1))}):void 0}});

$('.qa-post-content').readmore({
	speed: 200,
	collapsedHeight: 300,
	heightMargin: 0,
	moreLink: '<a href="#" class="show-more-btn">Show more...</a>',
	lessLink: '<a href="#" class="show-more-btn">Show less</a>',
	embedCSS: true,
	blockCSS: 'display: block; width: 100%;',
	startOpen: false,
});
